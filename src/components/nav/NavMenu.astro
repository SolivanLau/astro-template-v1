---
import Link from "@components/Link.astro";

const { menu } = Astro.props;
---

<ul id="menu">
    {
        // CMS menu
        menu.length > 0 ? (
            menu.map((item) => {
                // Regular Link
                if (item.__component === "shared.link") {
                    return (
                        <li>
                            <Link
                                url={item.url}
                                isLinkExternal={item.isLinkExternal}
                                class="menu-link"
                            >
                                {item.label}
                            </Link>
                        </li>
                    );
                }
                // Submenu
                if (item.__component === "navigation.link-sub-menu") {
                    const { menuTitle, menuUrl, link } = item;
                    return (
                        <li class="sub-menu">
                            <Link url={menuUrl}>{menuTitle}</Link>
                            <ul>
                                {link.map(({ url, label, isLinkExternal }) => {
                                    return (
                                        <li>
                                            <Link url={url} isLinkExternal={isLinkExternal}>
                                                {label}
                                            </Link>
                                        </li>
                                    );
                                })}
                            </ul>
                        </li>
                    );
                }
            })
        ) : (
            // Default menu
            <>
                <li>
                    <Link url="/about">About</Link>
                </li>
                <li>
                    <Link url="/things">Things</Link>
                </li>
                <li>
                    <Link url="/connect">Connect</Link>
                </li>
            </>
        )
    }
</ul>

<style lang="scss">
    @use "@styles/partials/abstracts" as *;

    ul {
        display: flex;
        gap: 40px;
        margin: 0;
    }
    // Nav Submenu
    .sub-menu {
        position: relative;

        > ul {
            position: absolute;
            top: calc(100% + 10px);
            right: 0px;
            width: 200px;
            padding: 25px 10px;
            background-color: #3d3d3d;
            opacity: 0;
            transform: translate(0, 15px);
            transition:
                opacity 0.4s ease-in-out 0.2s,
                transform 0.4s ease-in-out 0.2s;
            flex-direction: column;
        }

        &:hover,
        &:focus {
            > ul {
                opacity: 1;
                transform: translate(0, 0);
            }
        }
    }

    @include responsive-style(tablet) {
        ul {
            --menu-width: 70%;
            // position
            position: fixed;
            top: 0px;
            right: 0px;
            // dimensions
            min-height: 100vh;
            min-height: 100dvh;
            width: 70%;
            background-color: blue;
            // layout
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
            transform: translateX(100%);
            transition: transform 0.4s ease-in-out;
        }

        li[aria-current="page"] {
            font-weight: bold;
        }
    }

    @include responsive-style(mobile) {
        ul {
            width: 80%;
        }
    }
</style>
