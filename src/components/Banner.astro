---
import type { ImageMetadata } from "astro";
import { Picture } from "astro:assets";

interface Props {
    backgroundImgPath?: ImageMetadata;
    backgroundImgPosition?: "center" | "left" | "right";
    tagName?: "div" | "section" | "header";
    noWrapper?: boolean;
    class?: string;
    [key: string]: any;
}

const {
    backgroundImgPath,
    backgroundImgPosition = "right",
    tagName,
    noWrapper,
    class: className,
} = Astro.props;

const Tag = tagName ? tagName : "section";

// TODO:
// finish --img-left position
// start --img-center position
---

<Tag
    class:list={[
        backgroundImgPath &&
            `background__image-parent background__image-parent--img-${backgroundImgPosition}`,
        "background",
        "section__padding--lg",
        className,
    ]}
>
    <!-- CONTENT: with optional wrapper -->
    {
        noWrapper ? (
            <slot />
        ) : (
            <div class="wrapper">
                <slot />
            </div>
        )
    }

    <!-- OPTIONAL BACKGROUND IMAGE -->
    {
        backgroundImgPath && (
            <Picture
                class:list={[
                    "background__image",
                    `background__image--img-${backgroundImgPosition}`,
                ]}
                src={backgroundImgPath}
                alt="Toronto Wind Collective Ensemble"
                widths={[1920, 768]}
                formats={["webp", "jpg"]}
            />
        )
    }
</Tag>

<style lang="scss">
    @use "@styles/partials/abstracts/mixins" as *;

    // full background
    .background {
        background: var(--clr-brand-secondary);
    }
    // Background Image
    .background__image-parent {
        --_gradient-position: var(--clr-brand-secondary);
        --_img-position: ;

        background: var(
            --_gradient-position,
            linear-gradient(-85.41deg, rgba(66, 58, 112, 17%) 0%, #695c7c 58%)
        );

        .background__image {
            translate: var(--_img-position, 0);
        }

        // MODIFIERS
        &--img-right {
            --_gradient-position: linear-gradient(
                -85.41deg,
                rgba(66, 58, 112, 17%) 0%,
                #695c7c 58%
            );
            --_img-position: 30%;
        }

        &--img-left {
            --_gradient-position: linear-gradient(281deg, rgba(66, 58, 112, 17%) 0%, #695c7c 50%);
            --_img-position: 0;
        }
    }

    // LAYOUT
    @include responsive-style(mobile) {
        .background__image-parent {
            &--img-left {
                --_img-position: 0;
            }

            &--img-right {
                --_gradient-position: linear-gradient(
                    281deg,
                    rgba(66, 58, 112, 17%) 0%,
                    #695c7c 50%
                );
                --_img-position: 20%;
            }
        }
    }
</style>
